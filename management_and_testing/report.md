# 1 задание 
Какие баги я нашла и исправила:
1. Баг в Unet модели, в temb у нас был тензор размерности 2, который плохо маштабировался до размерности 4 -
 баг обнаружен запуском теста и еще размеры тензоров повыводила в Unet
2. Дальше методом пристального взгляда на диффузионную модель был замечен в сэмплировании шума - вместо нормально использовали равномерное в forward
3. Сверяла формулы со статьей и нашла ошибку в одной из них в forward
4. Когда попробовала запустить тест на gpu, модель много где падала из-за разных девайсов. Таким образом были добавлены
    корректные девайсы для самой модели в test_pipeline и внутри диффузии там, где мы что-то сэмплируем
5. Не знаю, считать ли это за баг или нет, но в тесте модель пыталась сохранить картинку в папку samples, которой не было,
   из-за чего все падало, добавила mkdir
6. Последний баг самый неприятный и который не сразу отловила - это нормализация картинок перед тем, как их сохранить. Заметила
    посмотрев на результаты в папке samples и дополнительно проверив min max выхода модели

Дополнительно в диффузию добавила возможность передавать шум и сэмплировать из него (чтобы проверять генерацию для одного и того же шума).
Также в training добавила логирование метрик и картинок.

Тест на полный пайплайн сделала на основе тест одного батча. Заменила цикл с одним батчом на цикл по батчам, при этом сильно ограничив 
датасет, чтобы слишком долго не ждать обучения на cpu. Добавила через parametrize возможные варианты для hidden_size и для device.
```commandline
---------- coverage: platform linux, python 3.10.13-final-0 ----------
Name                    Stmts   Miss  Cover
-------------------------------------------
modeling/__init__.py        0      0   100%
modeling/diffusion.py      34      0   100%
modeling/training.py       35      3    91%
modeling/unet.py           68      0   100%
------------------------------------------
TOTAL                     137      3    98%
```

Ссылка на wandb: [тык](https://wandb.ai/kvdmitrieva/efdl_hw)

- full_run - обучение на 100 эпох со стандартными параметрами
- остальные - эксперименты для гидры, названия соответствуют изменениям в конфиге, сами гиперпарметры запусков можно
 увидеть либо в артефактах (config.yaml), либо зайти в overview запуска.